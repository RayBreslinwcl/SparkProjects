# 一、事务管理偏移量原因

正常流程计算结果成功后，再提交偏移量给kafka。但是，会有意外，计算成功，但是提交kafka的偏移量失败。这就导致，重新消费消息，有时候对待金融这方面应用是无法容忍的。所以，需要把计算结果和偏移量提交放到同一个事务中，要不都成功，要不都失败。



# 二、实现事务思路

## 1.事务解决

采用把偏移量保存到支持事务的数据库mysql中，实现整体控制！

## 2.Streaming偏移量获取

参考官网：





